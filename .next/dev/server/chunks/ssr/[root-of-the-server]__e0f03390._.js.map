{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/auth.config.ts"],"sourcesContent":["import type { NextAuthConfig } from 'next-auth';\n\nexport const authConfig = {\n  pages: {\n    signIn: '/login',\n  },\n  callbacks: {\n    authorized({ auth, request: { nextUrl } }) {\n      const isLoggedIn = !!auth?.user;\n      const isOnDashboard = nextUrl.pathname.startsWith('/dashboard') || \n                            nextUrl.pathname.startsWith('/students') ||\n                            nextUrl.pathname.startsWith('/clubs') ||\n                            nextUrl.pathname.startsWith('/events') ||\n                            nextUrl.pathname.startsWith('/activities') ||\n                            nextUrl.pathname.startsWith('/memberships') ||\n                            nextUrl.pathname.startsWith('/resources') ||\n                            nextUrl.pathname.startsWith('/guests') ||\n                            nextUrl.pathname.startsWith('/reservations');\n      const isOnLogin = nextUrl.pathname.startsWith('/login');\n      const isOnRegister = nextUrl.pathname.startsWith('/register');\n      const isOnHome = nextUrl.pathname.startsWith('/home') || nextUrl.pathname === '/';\n\n      // Allow access to home, login, and register pages\n      if (isOnHome || isOnLogin || isOnRegister) {\n        if (isLoggedIn && (isOnLogin || isOnRegister)) {\n          return Response.redirect(new URL('/dashboard', nextUrl)); // Redirect logged-in users to dashboard\n        }\n        return true;\n      }\n\n      // Protect dashboard routes\n      if (isOnDashboard) {\n        if (isLoggedIn) return true;\n        return false; // Redirect unauthenticated users to login page\n      }\n      \n      // Default allow for other routes (like api, _next, static files)\n      return true;\n    },\n  },\n  providers: [], // Add providers with an empty array for now\n} satisfies NextAuthConfig;\n"],"names":[],"mappings":";;;;AAEO,MAAM,aAAa;IACxB,OAAO;QACL,QAAQ;IACV;IACA,WAAW;QACT,YAAW,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,EAAE;YACvC,MAAM,aAAa,CAAC,CAAC,MAAM;YAC3B,MAAM,gBAAgB,QAAQ,QAAQ,CAAC,UAAU,CAAC,iBAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC,gBAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC,aAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC,cAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC,kBAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC,mBAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC,iBAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC,cAC5B,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAClD,MAAM,YAAY,QAAQ,QAAQ,CAAC,UAAU,CAAC;YAC9C,MAAM,eAAe,QAAQ,QAAQ,CAAC,UAAU,CAAC;YACjD,MAAM,WAAW,QAAQ,QAAQ,CAAC,UAAU,CAAC,YAAY,QAAQ,QAAQ,KAAK;YAE9E,kDAAkD;YAClD,IAAI,YAAY,aAAa,cAAc;gBACzC,IAAI,cAAc,CAAC,aAAa,YAAY,GAAG;oBAC7C,OAAO,SAAS,QAAQ,CAAC,IAAI,IAAI,cAAc,WAAW,wCAAwC;gBACpG;gBACA,OAAO;YACT;YAEA,2BAA2B;YAC3B,IAAI,eAAe;gBACjB,IAAI,YAAY,OAAO;gBACvB,OAAO,OAAO,+CAA+C;YAC/D;YAEA,iEAAiE;YACjE,OAAO;QACT;IACF;IACA,WAAW,EAAE;AACf"}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3';\nimport path from 'path';\n\nconst dbPath = path.join(process.cwd(), 'data', 'cl0v.db');\n\nconst db = new Database(dbPath, { verbose: console.log});\n\ndb.pragma('foreign_keys = ON');\n\nexport default db;"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAEhD,MAAM,KAAK,IAAI,sIAAQ,CAAC,QAAQ;IAAE,SAAS,QAAQ,GAAG;AAAA;AAEtD,GAAG,MAAM,CAAC;uCAEK"}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/auth.ts"],"sourcesContent":["import NextAuth from 'next-auth';\nimport Credentials from 'next-auth/providers/credentials';\nimport { authConfig } from './auth.config';\nimport { z } from 'zod';\nimport db from './lib/db';\nimport type { Admin } from '@/types/db';\nimport bcrypt from 'bcryptjs';\n\nasync function getAdmin(email: string): Promise<Admin | undefined> {\n  try {\n    const admin = db.prepare('SELECT * FROM admins WHERE email = ?').get(email) as Admin | undefined;\n    return admin;\n  } catch (error) {\n    console.error('Failed to fetch admin:', error);\n    throw new Error('Failed to fetch admin.');\n  }\n}\n\nexport const { auth, signIn, signOut, handlers } = NextAuth({\n  ...authConfig,\n  providers: [\n    Credentials({\n      async authorize(credentials) {\n        const parsedCredentials = z\n          .object({ email: z.string().email(), password: z.string().min(6) })\n          .safeParse(credentials);\n\n        if (parsedCredentials.success) {\n          const { email, password } = parsedCredentials.data;\n          const admin = await getAdmin(email);\n\n          if (!admin) return null;\n          \n          // If admin has no password set (from migration), allowing login might be risky.\n          // But for now, we assume migration added a default or empty password.\n          // We must check if password matches.\n          if (!admin.password) return null;\n\n          if (admin.status !== 'accepted') {\n            console.log('Account not active');\n            return null;\n          }\n\n          const passwordsMatch = await bcrypt.compare(password, admin.password);\n          if (passwordsMatch) return admin;\n        }\n\n        console.log('Invalid credentials');\n        return null;\n      },\n    }),\n  ],\n});\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;AACA;AAEA;;;;;;;AAEA,eAAe,SAAS,KAAa;IACnC,IAAI;QACF,MAAM,QAAQ,4HAAE,CAAC,OAAO,CAAC,wCAAwC,GAAG,CAAC;QACrE,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,MAAM,EAAE,IAAI,EAAE,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,IAAA,4WAAQ,EAAC;IAC1D,GAAG,oIAAU;IACb,WAAW;QACT,IAAA,yOAAW,EAAC;YACV,MAAM,WAAU,WAAW;gBACzB,MAAM,oBAAoB,iOAAC,CACxB,MAAM,CAAC;oBAAE,OAAO,iOAAC,CAAC,MAAM,GAAG,KAAK;oBAAI,UAAU,iOAAC,CAAC,MAAM,GAAG,GAAG,CAAC;gBAAG,GAChE,SAAS,CAAC;gBAEb,IAAI,kBAAkB,OAAO,EAAE;oBAC7B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,kBAAkB,IAAI;oBAClD,MAAM,QAAQ,MAAM,SAAS;oBAE7B,IAAI,CAAC,OAAO,OAAO;oBAEnB,gFAAgF;oBAChF,sEAAsE;oBACtE,qCAAqC;oBACrC,IAAI,CAAC,MAAM,QAAQ,EAAE,OAAO;oBAE5B,IAAI,MAAM,MAAM,KAAK,YAAY;wBAC/B,QAAQ,GAAG,CAAC;wBACZ,OAAO;oBACT;oBAEA,MAAM,iBAAiB,MAAM,yMAAM,CAAC,OAAO,CAAC,UAAU,MAAM,QAAQ;oBACpE,IAAI,gBAAgB,OAAO;gBAC7B;gBAEA,QAAQ,GAAG,CAAC;gBACZ,OAAO;YACT;QACF;KACD;AACH"}},
    {"offset": {"line": 137, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/actions/auth-actions.ts"],"sourcesContent":["'use server';\n\nimport { signIn, signOut } from '@/auth';\nimport { AuthError } from 'next-auth';\n\nexport async function authenticate(\n  prevState: string | undefined,\n  formData: FormData,\n) {\n  try {\n    await signIn('credentials', formData);\n  } catch (error) {\n    if (error instanceof AuthError) {\n      switch (error.type) {\n        case 'CredentialsSignin':\n          return 'Invalid credentials.';\n        default:\n          return 'Something went wrong.';\n      }\n    }\n    throw error;\n  }\n}\n\nexport async function logout() {\n  await signOut({ redirectTo: '/login' });\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAAA;;;;;AAEO,eAAe,aACpB,SAA6B,EAC7B,QAAkB;IAElB,IAAI;QACF,MAAM,IAAA,sHAAM,EAAC,eAAe;IAC9B,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,yNAAS,EAAE;YAC9B,OAAQ,MAAM,IAAI;gBAChB,KAAK;oBACH,OAAO;gBACT;oBACE,OAAO;YACX;QACF;QACA,MAAM;IACR;AACF;AAEO,eAAe;IACpB,MAAM,IAAA,uHAAO,EAAC;QAAE,YAAY;IAAS;AACvC;;;IArBsB;IAmBA;;AAnBA,uXAAA;AAmBA,uXAAA"}},
    {"offset": {"line": 182, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/actions/student-actions.ts"],"sourcesContent":["'use server'\n\nimport db from '@/lib/db';\nimport { Student, Major, Event, Club, Activity } from '@/types/db';\nimport { revalidatePath } from 'next/cache';\n\n// --- HELPER TYPES ---\n// We define this here because the UI usually needs the Major Name, not just the ID\nexport type StudentWithMajor = Student & {\n  majorName: string | null;\n  clubCount: number;\n  activityCount: number;\n  eventCount: number;\n};\n\n// --- READ ---\n\nexport async function getStudents() {\n  // We JOIN with majors to get the readable name (e.g., 'IID') instead of just a number\n  // And we include counts for clubs, activities, and events\n  const students = db.prepare(`\n    SELECT \n      students.*, \n      majors.majorName,\n      (SELECT COUNT(*) FROM clubMemberships WHERE clubMemberships.studentId = students.studentId) as clubCount,\n      (SELECT COUNT(*) FROM registrations WHERE registrations.studentId = students.studentId) as activityCount,\n      (SELECT COUNT(*) FROM eventParticipants WHERE eventParticipants.studentId = students.studentId) as eventCount\n    FROM students \n    LEFT JOIN majors ON students.majorId = majors.majorId\n    ORDER BY students.lastName ASC\n  `).all() as StudentWithMajor[];\n  \n  return students;\n}\n\nexport async function getStudentEvents(studentId: number) {\n  const events = db.prepare(`\n    SELECT e.* \n    FROM events e\n    JOIN eventParticipants ep ON e.eventId = ep.eventId\n    WHERE ep.studentId = ?\n    ORDER BY e.startDate DESC\n  `).all(studentId) as Event[];\n  return events;\n}\n\nexport async function getStudentClubs(studentId: number) {\n  const clubs = db.prepare(`\n    SELECT c.* \n    FROM clubs c\n    JOIN clubMemberships cm ON c.clubId = cm.clubId\n    WHERE cm.studentId = ?\n    ORDER BY c.clubName ASC\n  `).all(studentId) as Club[];\n  return clubs;\n}\n\nexport async function getStudentActivities(studentId: number) {\n  const activities = db.prepare(`\n    SELECT a.* \n    FROM activities a\n    JOIN registrations r ON a.activityId = r.activityId\n    WHERE r.studentId = ?\n    ORDER BY a.startDate DESC\n  `).all(studentId) as Activity[];\n  return activities;\n}\n\nexport async function getTotalActivitiesCount() {\n  const result = db.prepare('SELECT COUNT(*) as count FROM activities').get() as { count: number };\n  return result.count;\n}\n\n// We need this to populate the <Select> dropdown in the Add/Edit form\nexport async function getMajors() {\n  return db.prepare('SELECT * FROM majors ORDER BY majorName ASC').all() as Major[];\n}\n\n// --- CREATE ---\n\nexport async function createStudent(formData: FormData) {\n  const firstName = formData.get('firstName') as string;\n  const lastName = formData.get('lastName') as string;\n  const cne = formData.get('cne') as string;\n  const email = formData.get('email') as string;\n  // Convert string \"1\" to number 1, or null if empty\n  const majorId = formData.get('majorId') ? parseInt(formData.get('majorId') as string) : null;\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO students (firstName, lastName, cne, email, majorId)\n      VALUES (@firstName, @lastName, @cne, @email, @majorId)\n    `);\n\n    stmt.run({ firstName, lastName, cne, email, majorId });\n    \n    revalidatePath('/students');\n    return { success: true, message: 'Student registered successfully' };\n  } catch (error: any) {\n    // Handle Unique Constraints (Duplicate CNE or Email)\n    if (error.code === 'SQLITE_CONSTRAINT_UNIQUE') {\n      return { success: false, message: 'Error: Student Code (CNE) or Email already exists.' };\n    }\n    return { success: false, message: error.message };\n  }\n}\n\n// --- UPDATE ---\n\nexport async function updateStudent(studentId: number, formData: FormData) {\n  const firstName = formData.get('firstName') as string;\n  const lastName = formData.get('lastName') as string;\n  const cne = formData.get('cne') as string;\n  const email = formData.get('email') as string;\n  const majorId = formData.get('majorId') ? parseInt(formData.get('majorId') as string) : null;\n\n  try {\n    const stmt = db.prepare(`\n      UPDATE students \n      SET firstName = @firstName, \n          lastName = @lastName, \n          cne = @cne, \n          email = @email, \n          majorId = @majorId\n      WHERE studentId = @studentId\n    `);\n\n    stmt.run({ firstName, lastName, cne, email, majorId, studentId });\n\n    revalidatePath('/students');\n    return { success: true, message: 'Student updated successfully' };\n  } catch (error: any) {\n    if (error.code === 'SQLITE_CONSTRAINT_UNIQUE') {\n      return { success: false, message: 'Error: Student Code or Email is already taken.' };\n    }\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE ---\n\nexport async function deleteStudent(studentId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM students WHERE studentId = ?');\n    stmt.run(studentId);\n\n    revalidatePath('/students');\n    return { success: true, message: 'Student deleted successfully' };\n  } catch (error: any) {\n    // SQLITE_CONSTRAINT_FOREIGNKEY happens if you try to delete a student \n    // who is arguably an \"Organizer\" of an event or has critical linked data.\n    // (Though usually, ON DELETE CASCADE handles this, it's good to be safe)\n    return { success: false, message: error.message };\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 386, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/actions/club-actions.ts"],"sourcesContent":["'use server'\n\nimport db from '@/lib/db';\nimport { Club } from '@/types/db';\nimport { revalidatePath } from 'next/cache';\n\n// --- CREATE ---\nexport async function createClub(formData: FormData) {\n  const clubName = formData.get('clubName') as string;\n  const category = formData.get('category') as string;\n  const description = formData.get('description') as string;\n  const createdAt = formData.get('createdAt') as string;\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO clubs (clubName, category, description, createdAt)\n      VALUES (@clubName, @category, @description, @createdAt)\n    `);\n\n    stmt.run({ clubName, category, description, createdAt });\n    \n    // Refresh the page data\n    revalidatePath('/clubs');\n    return { success: true, message: 'Club created successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- READ (Optional, usually done directly in Server Components) ---\nexport async function getClubs() {\n  const clubs = db.prepare('SELECT * FROM clubs ORDER BY createdAt DESC').all() as Club[];\n  return clubs;\n}\n\n// --- UPDATE ---\nexport async function updateClub(clubId: number, formData: FormData) {\n  const clubName = formData.get('clubName') as string;\n  const category = formData.get('category') as string;\n  const description = formData.get('description') as string;\n  const createdAt = formData.get('createdAt') as string;\n\n  try {\n    const stmt = db.prepare(`\n      UPDATE clubs \n      SET clubName = @clubName, \n          category = @category, \n          description = @description, \n          createdAt = @createdAt\n      WHERE clubId = @clubId\n    `);\n\n    stmt.run({ clubName, category, description, createdAt, clubId });\n\n    revalidatePath('/clubs');\n    return { success: true, message: 'Club updated successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE ---\nexport async function deleteClub(clubId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM clubs WHERE clubId = ?');\n    stmt.run(clubId);\n\n    revalidatePath('/clubs');\n    return { success: true, message: 'Club deleted successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- GET CLUBS BY EVENT ---\nexport async function getClubsByEvent(eventId: number) {\n  try {\n    const clubs = db.prepare(`\n      SELECT c.*\n      FROM clubs c\n      JOIN eventOrganizers eo ON c.clubId = eo.clubId\n      WHERE eo.eventId = ?\n    `).all(eventId);\n\n    return clubs || [];\n  } catch (error: any) {\n    console.error(\"Failed to fetch clubs for event:\", error);\n    return [];\n  }\n}\n\n// --- CLUB MEMBERSHIPS ---\nexport async function getClubMembers(clubId: number) {\n  try {\n    const members = db.prepare(`\n      SELECT s.*, cm.joinedAt\n      FROM students s\n      JOIN clubMemberships cm ON s.studentId = cm.studentId\n      WHERE cm.clubId = ?\n      ORDER BY cm.joinedAt DESC\n    `).all(clubId);\n    \n    return members;\n  } catch (error: any) {\n    console.error(\"Failed to fetch club members:\", error);\n    return [];\n  }\n}\n\nexport async function getClubEvents(clubId: number) {\n  try {\n    // Events where the club is an organizer\n    const events = db.prepare(`\n      SELECT e.*\n      FROM events e\n      JOIN eventOrganizers eo ON e.eventId = eo.eventId\n      WHERE eo.clubId = ?\n      ORDER BY e.startDate DESC\n    `).all(clubId);\n    return events;\n  } catch (error) {\n    console.error(\"Failed to fetch club events:\", error);\n    return [];\n  }\n}\n\nexport async function getClubActivities(clubId: number) {\n  try {\n    // Activities owned by the club\n    const activities = db.prepare(`\n      SELECT * FROM activities WHERE clubId = ? ORDER BY startDate DESC\n    `).all(clubId);\n    return activities;\n  } catch (error) {\n     console.error(\"Failed to fetch club activities:\", error);\n     return [];\n  }\n}\n\nexport async function getClubMemberships() {\n  try {\n    const rows = db.prepare(`\n      SELECT cm.membershipId, cm.joinedAt,\n             c.clubName as clubName, c.category as clubCategory,\n             s.studentId, s.firstName || ' ' || s.lastName as studentName, s.cne as studentCne, s.email as studentEmail\n      FROM clubMemberships cm\n      JOIN clubs c ON cm.clubId = c.clubId\n      JOIN students s ON cm.studentId = s.studentId\n      ORDER BY cm.joinedAt DESC\n    `).all();\n\n    return rows || [];\n  } catch (error: any) {\n    console.error('Failed to fetch club memberships', error);\n    return [];\n  }\n}\n\nexport async function createClubMembership(formData: FormData) {\n  const studentId = parseInt(formData.get('studentId') as string);\n  const clubId = parseInt(formData.get('clubId') as string);\n  const joinedAt = (formData.get('joinedAt') as string) || new Date().toISOString();\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO clubMemberships (joinedAt, clubId, studentId)\n      VALUES (@joinedAt, @clubId, @studentId)\n    `);\n\n    stmt.run({ joinedAt, clubId, studentId });\n    revalidatePath('/memberships');\n    return { success: true };\n  } catch (error: any) {\n    console.error('Failed to create club membership', error);\n    return { success: false, message: error.message };\n  }\n}\n\nexport async function deleteClubMembership(membershipId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM clubMemberships WHERE membershipId = ?');\n    stmt.run(membershipId);\n    revalidatePath('/memberships');\n    return { success: true };\n  } catch (error: any) {\n    console.error('Failed to delete club membership', error);\n    return { success: false, message: error.message };\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 644, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/.next-internal/server/app/%28dashboard%29/memberships/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {logout as '002248bac64ab24ef697de83b40bf4e9c7242fef37'} from 'ACTIONS_MODULE0'\nexport {getStudents as '0076e1ee761f3c725f60e6b94644d057cf1652cdf3'} from 'ACTIONS_MODULE1'\nexport {getClubs as '00545b232253d73c1b611478bd06ced735bf06d28f'} from 'ACTIONS_MODULE2'\nexport {getClubMemberships as '00ff9a47e4ba82e70e55d1e7f6cc89cce14b6f5f4d'} from 'ACTIONS_MODULE2'\nexport {createClubMembership as '40c977e9523458e7667dbc9361296afbfa11073e61'} from 'ACTIONS_MODULE2'\nexport {deleteClubMembership as '400bc84fe43569a50acb94ceb89e2811b94d78e4d0'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":";AAAA;AACA;AACA"}}]
}