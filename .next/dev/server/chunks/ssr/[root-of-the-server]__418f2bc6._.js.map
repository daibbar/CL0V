{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/lib/db.ts"],"sourcesContent":["import Database from 'better-sqlite3';\nimport path from 'path';\n\nconst dbPath = path.join(process.cwd(), 'data', 'cl0v.db');\n\nconst db = new Database(dbPath, { verbose: console.log});\n\ndb.pragma('foreign_keys = ON');\n\nexport default db;"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEA,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI,QAAQ;AAEhD,MAAM,KAAK,IAAI,sIAAQ,CAAC,QAAQ;IAAE,SAAS,QAAQ,GAAG;AAAA;AAEtD,GAAG,MAAM,CAAC;uCAEK"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/actions/register-action.ts"],"sourcesContent":["'use server';\n\nimport { z } from 'zod';\nimport db from '@/lib/db';\nimport bcrypt from 'bcryptjs';\nimport { redirect } from 'next/navigation';\n\nconst RegisterSchema = z.object({\n  firstName: z.string().min(2, 'First name must be at least 2 characters'),\n  lastName: z.string().min(2, 'Last name must be at least 2 characters'),\n  email: z.string().email('Invalid email address'),\n  password: z.string().min(6, 'Password must be at least 6 characters'),\n});\n\nexport type RegisterState = {\n  errors?: {\n    firstName?: string[];\n    lastName?: string[];\n    email?: string[];\n    password?: string[];\n  };\n  message?: string | null;\n};\n\nexport async function registerAdmin(prevState: RegisterState, formData: FormData) {\n  const validatedFields = RegisterSchema.safeParse({\n    firstName: formData.get('firstName'),\n    lastName: formData.get('lastName'),\n    email: formData.get('email'),\n    password: formData.get('password'),\n  });\n\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n      message: 'Missing Fields. Failed to Register.',\n    };\n  }\n\n  const { firstName, lastName, email, password } = validatedFields.data;\n  const hashedPassword = await bcrypt.hash(password, 10);\n\n  try {\n    // Check if email already exists\n    const existingAdmin = db.prepare('SELECT 1 FROM admins WHERE email = ?').get(email);\n    if (existingAdmin) {\n        return {\n            message: 'Email already in use.',\n            errors: { email: ['Email already in use.'] }\n        };\n    }\n\n    db.prepare(`\n      INSERT INTO admins (firstName, lastName, email, password, status)\n      VALUES (?, ?, ?, ?, 'pending')\n    `).run(firstName, lastName, email, hashedPassword);\n  } catch (error) {\n    console.error('Registration failed:', error);\n    return {\n      message: 'Database Error: Failed to Create Admin.',\n    };\n  }\n\n  redirect('/login');\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;;;;;;;AAEA,MAAM,iBAAiB,iOAAC,CAAC,MAAM,CAAC;IAC9B,WAAW,iOAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC7B,UAAU,iOAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;IAC5B,OAAO,iOAAC,CAAC,MAAM,GAAG,KAAK,CAAC;IACxB,UAAU,iOAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG;AAC9B;AAYO,eAAe,cAAc,SAAwB,EAAE,QAAkB;IAC9E,MAAM,kBAAkB,eAAe,SAAS,CAAC;QAC/C,WAAW,SAAS,GAAG,CAAC;QACxB,UAAU,SAAS,GAAG,CAAC;QACvB,OAAO,SAAS,GAAG,CAAC;QACpB,UAAU,SAAS,GAAG,CAAC;IACzB;IAEA,IAAI,CAAC,gBAAgB,OAAO,EAAE;QAC5B,OAAO;YACL,QAAQ,gBAAgB,KAAK,CAAC,OAAO,GAAG,WAAW;YACnD,SAAS;QACX;IACF;IAEA,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,gBAAgB,IAAI;IACrE,MAAM,iBAAiB,MAAM,yMAAM,CAAC,IAAI,CAAC,UAAU;IAEnD,IAAI;QACF,gCAAgC;QAChC,MAAM,gBAAgB,4HAAE,CAAC,OAAO,CAAC,wCAAwC,GAAG,CAAC;QAC7E,IAAI,eAAe;YACf,OAAO;gBACH,SAAS;gBACT,QAAQ;oBAAE,OAAO;wBAAC;qBAAwB;gBAAC;YAC/C;QACJ;QAEA,4HAAE,CAAC,OAAO,CAAC,CAAC;;;IAGZ,CAAC,EAAE,GAAG,CAAC,WAAW,UAAU,OAAO;IACrC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,OAAO;YACL,SAAS;QACX;IACF;IAEA,IAAA,yUAAQ,EAAC;AACX;;;IAxCsB;;AAAA,uXAAA"}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///home/daibbar/projects/CL0V/.next-internal/server/app/register/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {registerAdmin as '60d2d4d1515d63fd07b2479cf393ec2a26e0f9dfce'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}