{"version":3,"sources":["../../../../../CL0V/actions/student-actions.ts","../../../../../CL0V/actions/club-actions.ts","../../../../../CL0V/actions/activity-actions.ts","../../../../../CL0V/actions/event-actions.ts"],"sourcesContent":["'use server'\n\nimport db from '@/lib/db';\nimport { Student, Major, Event, Club, Activity } from '@/types/db';\nimport { revalidatePath } from 'next/cache';\n\n// --- HELPER TYPES ---\n// We define this here because the UI usually needs the Major Name, not just the ID\nexport type StudentWithMajor = Student & {\n  majorName: string | null;\n  clubCount: number;\n  activityCount: number;\n  eventCount: number;\n};\n\n// --- READ ---\n\nexport async function getStudents() {\n  // We JOIN with majors to get the readable name (e.g., 'IID') instead of just a number\n  // And we include counts for clubs, activities, and events\n  const students = db.prepare(`\n    SELECT \n      students.*, \n      majors.majorName,\n      (SELECT COUNT(*) FROM clubMemberships WHERE clubMemberships.studentId = students.studentId) as clubCount,\n      (SELECT COUNT(*) FROM registrations WHERE registrations.studentId = students.studentId) as activityCount,\n      (SELECT COUNT(*) FROM eventParticipants WHERE eventParticipants.studentId = students.studentId) as eventCount\n    FROM students \n    LEFT JOIN majors ON students.majorId = majors.majorId\n    ORDER BY students.lastName ASC\n  `).all() as StudentWithMajor[];\n  \n  return students;\n}\n\nexport async function getStudentEvents(studentId: number) {\n  const events = db.prepare(`\n    SELECT e.* \n    FROM events e\n    JOIN eventParticipants ep ON e.eventId = ep.eventId\n    WHERE ep.studentId = ?\n    ORDER BY e.startDate DESC\n  `).all(studentId) as Event[];\n  return events;\n}\n\nexport async function getStudentClubs(studentId: number) {\n  const clubs = db.prepare(`\n    SELECT c.* \n    FROM clubs c\n    JOIN clubMemberships cm ON c.clubId = cm.clubId\n    WHERE cm.studentId = ?\n    ORDER BY c.clubName ASC\n  `).all(studentId) as Club[];\n  return clubs;\n}\n\nexport async function getStudentActivities(studentId: number) {\n  const activities = db.prepare(`\n    SELECT a.* \n    FROM activities a\n    JOIN registrations r ON a.activityId = r.activityId\n    WHERE r.studentId = ?\n    ORDER BY a.startDate DESC\n  `).all(studentId) as Activity[];\n  return activities;\n}\n\nexport async function getTotalActivitiesCount() {\n  const result = db.prepare('SELECT COUNT(*) as count FROM activities').get() as { count: number };\n  return result.count;\n}\n\n// We need this to populate the <Select> dropdown in the Add/Edit form\nexport async function getMajors() {\n  return db.prepare('SELECT * FROM majors ORDER BY majorName ASC').all() as Major[];\n}\n\n// --- CREATE ---\n\nexport async function createStudent(formData: FormData) {\n  const firstName = formData.get('firstName') as string;\n  const lastName = formData.get('lastName') as string;\n  const cne = formData.get('cne') as string;\n  const email = formData.get('email') as string;\n  // Convert string \"1\" to number 1, or null if empty\n  const majorId = formData.get('majorId') ? parseInt(formData.get('majorId') as string) : null;\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO students (firstName, lastName, cne, email, majorId)\n      VALUES (@firstName, @lastName, @cne, @email, @majorId)\n    `);\n\n    stmt.run({ firstName, lastName, cne, email, majorId });\n    \n    revalidatePath('/students');\n    return { success: true, message: 'Student registered successfully' };\n  } catch (error: any) {\n    // Handle Unique Constraints (Duplicate CNE or Email)\n    if (error.code === 'SQLITE_CONSTRAINT_UNIQUE') {\n      return { success: false, message: 'Error: Student Code (CNE) or Email already exists.' };\n    }\n    return { success: false, message: error.message };\n  }\n}\n\n// --- UPDATE ---\n\nexport async function updateStudent(studentId: number, formData: FormData) {\n  const firstName = formData.get('firstName') as string;\n  const lastName = formData.get('lastName') as string;\n  const cne = formData.get('cne') as string;\n  const email = formData.get('email') as string;\n  const majorId = formData.get('majorId') ? parseInt(formData.get('majorId') as string) : null;\n\n  try {\n    const stmt = db.prepare(`\n      UPDATE students \n      SET firstName = @firstName, \n          lastName = @lastName, \n          cne = @cne, \n          email = @email, \n          majorId = @majorId\n      WHERE studentId = @studentId\n    `);\n\n    stmt.run({ firstName, lastName, cne, email, majorId, studentId });\n\n    revalidatePath('/students');\n    return { success: true, message: 'Student updated successfully' };\n  } catch (error: any) {\n    if (error.code === 'SQLITE_CONSTRAINT_UNIQUE') {\n      return { success: false, message: 'Error: Student Code or Email is already taken.' };\n    }\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE ---\n\nexport async function deleteStudent(studentId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM students WHERE studentId = ?');\n    stmt.run(studentId);\n\n    revalidatePath('/students');\n    return { success: true, message: 'Student deleted successfully' };\n  } catch (error: any) {\n    // SQLITE_CONSTRAINT_FOREIGNKEY happens if you try to delete a student \n    // who is arguably an \"Organizer\" of an event or has critical linked data.\n    // (Though usually, ON DELETE CASCADE handles this, it's good to be safe)\n    return { success: false, message: error.message };\n  }\n}","'use server'\n\nimport db from '@/lib/db';\nimport { Club } from '@/types/db';\nimport { revalidatePath } from 'next/cache';\n\n// --- CREATE ---\nexport async function createClub(formData: FormData) {\n  const clubName = formData.get('clubName') as string;\n  const category = formData.get('category') as string;\n  const description = formData.get('description') as string;\n  const createdAt = formData.get('createdAt') as string;\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO clubs (clubName, category, description, createdAt)\n      VALUES (@clubName, @category, @description, @createdAt)\n    `);\n\n    stmt.run({ clubName, category, description, createdAt });\n    \n    // Refresh the page data\n    revalidatePath('/clubs');\n    return { success: true, message: 'Club created successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- READ (Optional, usually done directly in Server Components) ---\nexport async function getClubs() {\n  const clubs = db.prepare('SELECT * FROM clubs ORDER BY createdAt DESC').all() as Club[];\n  return clubs;\n}\n\n// --- UPDATE ---\nexport async function updateClub(clubId: number, formData: FormData) {\n  const clubName = formData.get('clubName') as string;\n  const category = formData.get('category') as string;\n  const description = formData.get('description') as string;\n  const createdAt = formData.get('createdAt') as string;\n\n  try {\n    const stmt = db.prepare(`\n      UPDATE clubs \n      SET clubName = @clubName, \n          category = @category, \n          description = @description, \n          createdAt = @createdAt\n      WHERE clubId = @clubId\n    `);\n\n    stmt.run({ clubName, category, description, createdAt, clubId });\n\n    revalidatePath('/clubs');\n    return { success: true, message: 'Club updated successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE ---\nexport async function deleteClub(clubId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM clubs WHERE clubId = ?');\n    stmt.run(clubId);\n\n    revalidatePath('/clubs');\n    return { success: true, message: 'Club deleted successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- GET CLUBS BY EVENT ---\nexport async function getClubsByEvent(eventId: number) {\n  try {\n    const clubs = db.prepare(`\n      SELECT c.*\n      FROM clubs c\n      JOIN eventOrganizers eo ON c.clubId = eo.clubId\n      WHERE eo.eventId = ?\n    `).all(eventId);\n\n    return clubs || [];\n  } catch (error: any) {\n    console.error(\"Failed to fetch clubs for event:\", error);\n    return [];\n  }\n}\n\n// --- CLUB MEMBERSHIPS ---\nexport async function getClubMembers(clubId: number) {\n  try {\n    const members = db.prepare(`\n      SELECT s.*, cm.joinedAt\n      FROM students s\n      JOIN clubMemberships cm ON s.studentId = cm.studentId\n      WHERE cm.clubId = ?\n      ORDER BY cm.joinedAt DESC\n    `).all(clubId);\n    \n    return members;\n  } catch (error: any) {\n    console.error(\"Failed to fetch club members:\", error);\n    return [];\n  }\n}\n\nexport async function getClubEvents(clubId: number) {\n  try {\n    // Events where the club is an organizer\n    const events = db.prepare(`\n      SELECT e.*\n      FROM events e\n      JOIN eventOrganizers eo ON e.eventId = eo.eventId\n      WHERE eo.clubId = ?\n      ORDER BY e.startDate DESC\n    `).all(clubId);\n    return events;\n  } catch (error) {\n    console.error(\"Failed to fetch club events:\", error);\n    return [];\n  }\n}\n\nexport async function getClubActivities(clubId: number) {\n  try {\n    // Activities owned by the club\n    const activities = db.prepare(`\n      SELECT * FROM activities WHERE clubId = ? ORDER BY startDate DESC\n    `).all(clubId);\n    return activities;\n  } catch (error) {\n     console.error(\"Failed to fetch club activities:\", error);\n     return [];\n  }\n}\n\nexport async function getClubMemberships() {\n  try {\n    const rows = db.prepare(`\n      SELECT cm.membershipId, cm.joinedAt,\n             c.clubName as clubName, c.category as clubCategory,\n             s.studentId, s.firstName || ' ' || s.lastName as studentName, s.cne as studentCne, s.email as studentEmail\n      FROM clubMemberships cm\n      JOIN clubs c ON cm.clubId = c.clubId\n      JOIN students s ON cm.studentId = s.studentId\n      ORDER BY cm.joinedAt DESC\n    `).all();\n\n    return rows || [];\n  } catch (error: any) {\n    console.error('Failed to fetch club memberships', error);\n    return [];\n  }\n}\n\nexport async function createClubMembership(formData: FormData) {\n  const studentId = parseInt(formData.get('studentId') as string);\n  const clubId = parseInt(formData.get('clubId') as string);\n  const joinedAt = (formData.get('joinedAt') as string) || new Date().toISOString();\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO clubMemberships (joinedAt, clubId, studentId)\n      VALUES (@joinedAt, @clubId, @studentId)\n    `);\n\n    stmt.run({ joinedAt, clubId, studentId });\n    revalidatePath('/memberships');\n    return { success: true };\n  } catch (error: any) {\n    console.error('Failed to create club membership', error);\n    return { success: false, message: error.message };\n  }\n}\n\nexport async function deleteClubMembership(membershipId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM clubMemberships WHERE membershipId = ?');\n    stmt.run(membershipId);\n    revalidatePath('/memberships');\n    return { success: true };\n  } catch (error: any) {\n    console.error('Failed to delete club membership', error);\n    return { success: false, message: error.message };\n  }\n}","'use server'\n\nimport db from '@/lib/db';\nimport { Activity, Event, Registration, Reservation } from '@/types/db';\nimport { revalidatePath } from 'next/cache';\n\n// --- TYPES ---\nexport type ActivityWithRelations = Activity & {\n  eventName?: string | null;\n  clubName?: string | null;\n};\n\n// --- CREATE ACTIVITY ---\nexport async function createActivity(formData: FormData) {\n  const activityName = formData.get('activityName') as string;\n  const description = formData.get('description') as string;\n  const type = formData.get('type') as string;\n  const maxCapacity = formData.get('maxCapacity') ? Number(formData.get('maxCapacity')) : null;\n  const startDate = formData.get('startDate') as string;\n  const endDate = formData.get('endDate') as string;\n  const clubId = formData.get('clubId') ? Number(formData.get('clubId')) : null;\n  const eventId = formData.get('eventId') ? Number(formData.get('eventId')) : null;\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO activities (activityName, description, type, maxCapacity, startDate, endDate, clubId, eventId)\n      VALUES (@activityName, @description, @type, @maxCapacity, @startDate, @endDate, @clubId, @eventId)\n    `);\n\n    stmt.run({ activityName, description, type, maxCapacity, startDate, endDate, clubId, eventId });\n    \n    revalidatePath('/activities');\n    return { success: true, message: 'Activity created successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- READ ACTIVITIES ---\nexport async function getActivities() {\n  try {\n    const activities = db.prepare(`\n      SELECT \n        a.*,\n        e.eventName,\n        c.clubName\n      FROM activities a\n      LEFT JOIN events e ON a.eventId = e.eventId\n      LEFT JOIN clubs c ON a.clubId = c.clubId\n      ORDER BY a.startDate DESC\n    `).all() as ActivityWithRelations[];\n    \n    return activities;\n  } catch (error: any) {\n    console.error(\"Failed to fetch activities:\", error);\n    return [];\n  }\n}\n\n// --- GET ACTIVITY BY ID ---\nexport async function getActivityById(activityId: number) {\n  try {\n    const activity = db.prepare(`\n      SELECT \n        a.*,\n        e.eventName,\n        c.clubName\n      FROM activities a\n      LEFT JOIN events e ON a.eventId = e.eventId\n      LEFT JOIN clubs c ON a.clubId = c.clubId\n      WHERE a.activityId = ?\n    `).get(activityId) as ActivityWithRelations | undefined;\n    \n    return activity || null;\n  } catch (error: any) {\n    console.error(\"Failed to fetch activity:\", error);\n    return null;\n  }\n}\n\n// --- UPDATE ACTIVITY ---\nexport async function updateActivity(activityId: number, formData: FormData) {\n  const activityName = formData.get('activityName') as string;\n  const description = formData.get('description') as string;\n  const type = formData.get('type') as string;\n  const maxCapacity = formData.get('maxCapacity') ? Number(formData.get('maxCapacity')) : null;\n  const startDate = formData.get('startDate') as string;\n  const endDate = formData.get('endDate') as string;\n  const clubId = formData.get('clubId') ? Number(formData.get('clubId')) : null;\n  const eventId = formData.get('eventId') ? Number(formData.get('eventId')) : null;\n\n  try {\n    const stmt = db.prepare(`\n      UPDATE activities \n      SET activityName = @activityName,\n          description = @description,\n          type = @type,\n          maxCapacity = @maxCapacity,\n          startDate = @startDate,\n          endDate = @endDate,\n          clubId = @clubId,\n          eventId = @eventId\n      WHERE activityId = @activityId\n    `);\n\n    stmt.run({ activityName, description, type, maxCapacity, startDate, endDate, clubId, eventId, activityId });\n\n    revalidatePath('/activities');\n    return { success: true, message: 'Activity updated successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE ACTIVITY ---\nexport async function deleteActivity(activityId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM activities WHERE activityId = ?');\n    stmt.run(activityId);\n\n    revalidatePath('/activities');\n    return { success: true, message: 'Activity deleted successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- GET ACTIVITY REGISTRATIONS (Students registered for activity) ---\nexport async function getActivityRegistrations(activityId: number) {\n  try {\n    const registrations = db.prepare(`\n      SELECT \n        r.*,\n        s.firstName,\n        s.lastName,\n        s.cne,\n        s.email\n      FROM registrations r\n      JOIN students s ON r.studentId = s.studentId\n      WHERE r.activityId = ?\n      ORDER BY s.lastName ASC\n    `).all(activityId);\n    \n    return registrations || [];\n  } catch (error: any) {\n    console.error(\"Failed to fetch registrations:\", error);\n    return [];\n  }\n}\n\n// --- ADD STUDENT TO ACTIVITY ---\nexport async function addStudentToActivity(formData: FormData) {\n  const activityId = Number(formData.get('activityId'));\n  const studentId = Number(formData.get('studentId'));\n\n  if (!activityId || !studentId) {\n    return { success: false, message: 'Invalid Activity or Student ID' };\n  }\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO registrations (studentId, activityId)\n      VALUES (@studentId, @activityId)\n    `);\n\n    stmt.run({ studentId, activityId });\n\n    revalidatePath('/activities');\n    return { success: true, message: 'Student successfully registered for activity' };\n  } catch (error: any) {\n    if (error.code === 'SQLITE_CONSTRAINT_PRIMARYKEY' || error.code === 'SQLITE_CONSTRAINT_UNIQUE') {\n      return { success: false, message: 'Student is already registered for this activity' };\n    }\n    return { success: false, message: error.message };\n  }\n}\n\n// --- REMOVE STUDENT FROM ACTIVITY ---\nexport async function removeStudentFromActivity(formData: FormData) {\n  const activityId = Number(formData.get('activityId'));\n  const studentId = Number(formData.get('studentId'));\n\n  if (!activityId || !studentId) {\n    return { success: false, message: 'Invalid Activity or Student ID' };\n  }\n\n  try {\n    const stmt = db.prepare('DELETE FROM registrations WHERE activityId = ? AND studentId = ?');\n    stmt.run(activityId, studentId);\n\n    revalidatePath('/activities');\n    return { success: true, message: 'Student removed from activity' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- GET ACTIVITY RESERVATIONS ---\nexport async function getActivityReservations(activityId: number) {\n  try {\n    const reservations = db.prepare(`\n      SELECT \n        res.*,\n        r.resourceName,\n        r.type\n      FROM reservations res\n      JOIN resources r ON res.resourceId = r.resourceId\n      WHERE res.activityId = ?\n      ORDER BY res.startDate ASC\n    `).all(activityId);\n    \n    return reservations || [];\n  } catch (error: any) {\n    console.error(\"Failed to fetch reservations:\", error);\n    return [];\n  }\n}\n\n// --- GET ACTIVITY EVENT ---\nexport async function getActivityEvent(eventId: number | null) {\n  if (!eventId) return null;\n  \n  try {\n    const event = db.prepare(`\n      SELECT * FROM events WHERE eventId = ?\n    `).get(eventId) as Event | undefined;\n    \n    return event || null;\n  } catch (error: any) {\n    console.error(\"Failed to fetch event:\", error);\n    return null;\n  }\n}\n\n// --- GET ACTIVITY CLUB ---\nexport async function getActivityClub(clubId: number | null) {\n  if (!clubId) return null;\n  \n  try {\n    const club = db.prepare(`\n      SELECT * FROM clubs WHERE clubId = ?\n    `).get(clubId);\n    \n    return club || null;\n  } catch (error: any) {\n    console.error(\"Failed to fetch club:\", error);\n    return null;\n  }\n}\n\n// --- GET ACTIVITY GUESTS ---\nexport async function getActivityGuests(activityId: number) {\n  try {\n    const guests = db.prepare(`\n      SELECT gr.*, g.fullName, g.email, g.phone\n      FROM guestRoles gr\n      JOIN guests g ON gr.guestId = g.guestId\n      WHERE gr.activityId = ?\n      ORDER BY gr.startDate ASC\n    `).all(activityId);\n\n    return guests || [];\n  } catch (error: any) {\n    console.error(\"Failed to fetch activity guests:\", error);\n    return [];\n  }\n}\n\n// --- ADD GUEST TO ACTIVITY ---\nexport async function addGuestToActivity(formData: FormData) {\n  const activityId = Number(formData.get('activityId'));\n  const guestId = Number(formData.get('guestId'));\n  const roleDescription = formData.get('roleDescription') as string;\n  const startDate = formData.get('startDate') as string;\n  const endDate = formData.get('endDate') as string;\n\n  if (!activityId || !guestId) {\n    return { success: false, message: 'Invalid Activity or Guest ID' };\n  }\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO guestRoles (guestId, activityId, roleDescription, startDate, endDate)\n      VALUES (@guestId, @activityId, @roleDescription, @startDate, @endDate)\n    `);\n\n    stmt.run({ guestId, activityId, roleDescription, startDate, endDate });\n\n    revalidatePath('/activities');\n    return { success: true, message: 'Guest added to activity successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- REMOVE GUEST FROM ACTIVITY ---\nexport async function removeGuestFromActivity(guestRoleId: number) {\n  if (!guestRoleId) {\n    return { success: false, message: 'Invalid Guest Role ID' };\n  }\n\n  try {\n    const stmt = db.prepare('DELETE FROM guestRoles WHERE guestRoleId = ?');\n    stmt.run(guestRoleId);\n\n    revalidatePath('/activities');\n    return { success: true, message: 'Guest removed from activity' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}","'use server'\n\nimport db from '@/lib/db';\nimport { revalidatePath } from 'next/cache';\nimport { Event, Student } from '@/types/db'; \n\n// --- CREATE EVENT ---\nexport async function createEvent(formData: FormData) {\n  const eventName = formData.get('eventName') as string;\n  const startDate = formData.get('startDate') as string;\n  const endDate = formData.get('endDate') as string;\n  // clubIds is expected to be a JSON string of numbers, e.g., \"[1, 2]\"\n  const clubIdsJson = formData.get('clubIds') as string; \n  let clubIds: number[] = [];\n  \n  if (clubIdsJson) {\n    try {\n      clubIds = JSON.parse(clubIdsJson);\n    } catch (e) {\n      console.error(\"Invalid clubIds JSON\", e);\n    }\n  }\n\n  try {\n    const createTransaction = db.transaction(() => {\n        const stmt = db.prepare(`\n        INSERT INTO events (eventName, startDate, endDate)\n        VALUES (@eventName, @startDate, @endDate)\n        `);\n        const info = stmt.run({ eventName, startDate, endDate });\n        const eventId = info.lastInsertRowid;\n\n        if (clubIds.length > 0) {\n            const insertOrg = db.prepare(`\n                INSERT INTO eventOrganizers (eventId, clubId) VALUES (?, ?)\n            `);\n            for (const clubId of clubIds) {\n                insertOrg.run(eventId, clubId);\n            }\n        }\n        return eventId;\n    });\n\n    createTransaction();\n    \n    revalidatePath('/events');\n    return { success: true, message: 'Event created successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- READ EVENTS (Optional utility) ---\nexport async function getEvents() {\n  try {\n    const events = db.prepare('SELECT * FROM events ORDER BY startDate DESC').all() as Event[];\n    return events;\n  } catch (error: any) {\n    console.error(\"Failed to fetch events:\", error);\n    return [];\n  }\n}\n\n// --- UPDATE EVENT ---\nexport async function updateEvent(eventId: number, formData: FormData) {\n  const eventName = formData.get('eventName') as string;\n  const startDate = formData.get('startDate') as string;\n  const endDate = formData.get('endDate') as string;\n  const clubIdsJson = formData.get('clubIds') as string;\n  let clubIds: number[] = [];\n\n  if (clubIdsJson) {\n    try {\n      clubIds = JSON.parse(clubIdsJson);\n    } catch (e) {\n      console.error(\"Invalid clubIds JSON\", e);\n    }\n  }\n\n  try {\n    const updateTransaction = db.transaction(() => {\n        const stmt = db.prepare(`\n        UPDATE events \n        SET eventName = @eventName, \n            startDate = @startDate, \n            endDate = @endDate\n        WHERE eventId = @eventId\n        `);\n        stmt.run({ eventName, startDate, endDate, eventId });\n\n        // Update organizers: delete existing, insert new\n        // Only do this if clubIds was actually passed (even if empty array, meaning clear all)\n        // If undefined/null logic was needed we'd check formData.has('clubIds'), but here we assume it's sent.\n        if (clubIdsJson !== null) { \n             const deleteOrgs = db.prepare('DELETE FROM eventOrganizers WHERE eventId = ?');\n             deleteOrgs.run(eventId);\n\n             if (clubIds.length > 0) {\n                 const insertOrg = db.prepare('INSERT INTO eventOrganizers (eventId, clubId) VALUES (?, ?)');\n                 for (const clubId of clubIds) {\n                     insertOrg.run(eventId, clubId);\n                 }\n             }\n        }\n    });\n\n    updateTransaction();\n\n    revalidatePath('/events');\n    return { success: true, message: 'Event updated successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE EVENT ---\nexport async function deleteEvent(eventId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM events WHERE eventId = ?');\n    stmt.run(eventId);\n\n    revalidatePath('/events');\n    return { success: true, message: 'Event deleted successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- ADD STUDENT TO EVENT (Attendance) ---\nexport async function addStudentToEvent(formData: FormData) {\n  const eventId = Number(formData.get('eventId'));\n  const studentId = Number(formData.get('studentId'));\n\n  if (!eventId || !studentId) {\n    return { success: false, message: 'Invalid Event or Student ID' };\n  }\n\n  try {\n    // Uses the camelCase table name 'eventParticipants' matching your schema\n    const stmt = db.prepare(`\n      INSERT INTO eventParticipants (eventId, studentId)\n      VALUES (@eventId, @studentId)\n    `);\n\n    stmt.run({ eventId, studentId });\n\n    // Revalidate events to update the UI counts/lists immediately\n    revalidatePath('/events');\n    return { success: true, message: 'Student successfully registered for event' };\n\n  } catch (error: any) {\n    // Handle Unique Constraint (Student already added)\n    if (error.code === 'SQLITE_CONSTRAINT_PRIMARYKEY' || error.code === 'SQLITE_CONSTRAINT_UNIQUE') {\n      return { success: false, message: 'Student is already registered for this event' };\n    }\n    return { success: false, message: error.message };\n  }\n}\n\n// --- REMOVE STUDENT FROM EVENT ---\nexport async function removeStudentFromEvent(formData: FormData) {\n    const eventId = Number(formData.get('eventId'));\n    const studentId = Number(formData.get('studentId'));\n\n    if (!eventId || !studentId) {\n        return { success: false, message: 'Invalid Event or Student ID' };\n    }\n\n    try {\n        const stmt = db.prepare('DELETE FROM eventParticipants WHERE eventId = ? AND studentId = ?');\n        stmt.run(eventId, studentId);\n        \n        revalidatePath('/events');\n        return { success: true, message: 'Student removed from event' };\n    } catch (error: any) {\n        return { success: false, message: error.message };\n    }\n}\n\n// --- GET EVENT PARTICIPANTS ---\nexport async function getEventParticipants(eventId: number) {\n  try {\n    const participants = db.prepare(`\n      SELECT s.*\n      FROM eventParticipants ep\n      JOIN students s ON ep.studentId = s.studentId\n      WHERE ep.eventId = ?\n      ORDER BY s.lastName ASC\n    `).all(eventId) as Student[];\n\n    return participants || [];\n  } catch (error: any) {\n    console.error(\"Failed to fetch event participants:\", error);\n    return [];\n  }\n}"],"names":[],"mappings":"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"}