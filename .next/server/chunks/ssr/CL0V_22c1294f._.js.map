{"version":3,"sources":["../../../../../CL0V/actions/guest-actions.ts","../../../../../CL0V/.next-internal/server/app/%28dashboard%29/activities/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["'use server'\n\nimport db from '@/lib/db';\nimport { Guest, GuestRole } from '@/types/db';\nimport { revalidatePath } from 'next/cache';\n\n// --- READ GUESTS ---\nexport async function getGuests() {\n  try {\n    const guests = db.prepare('SELECT * FROM guests ORDER BY fullName ASC').all() as Guest[];\n    return guests;\n  } catch (error: any) {\n    console.error(\"Failed to fetch guests:\", error);\n    return [];\n  }\n}\n\n// --- CREATE GUEST ---\nexport async function createGuest(formData: FormData) {\n  const fullName = formData.get('guest_name') as string;\n  const phone = formData.get('guest_phone') as string;\n  const email = formData.get('guest_email') as string;\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO guests (fullName, phone, email)\n      VALUES (@fullName, @phone, @email)\n    `);\n\n    stmt.run({ fullName, phone, email });\n    \n    revalidatePath('/guests');\n    return { success: true, message: 'Guest created successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE GUEST ---\nexport async function deleteGuest(guestId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM guests WHERE guestId = ?');\n    stmt.run(guestId);\n\n    revalidatePath('/guests');\n    return { success: true, message: 'Guest deleted successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- GET GUEST ACTIVITIES ---\nexport type GuestActivityInvitation = {\n  activityName: string;\n  activityType: string;\n  startDate: string;\n  roleDescription: string;\n  eventName: string | null;\n  clubName: string | null;\n};\n\nexport async function getGuestActivities(guestId: number) {\n  try {\n    const activities = db.prepare(`\n      SELECT \n        a.activityName,\n        a.type as activityType,\n        a.startDate,\n        gr.roleDescription,\n        e.eventName,\n        c.clubName\n      FROM guestRoles gr\n      JOIN activities a ON gr.activityId = a.activityId\n      LEFT JOIN events e ON a.eventId = e.eventId\n      LEFT JOIN clubs c ON a.clubId = c.clubId\n      WHERE gr.guestId = ?\n      ORDER BY a.startDate DESC\n    `).all(guestId) as GuestActivityInvitation[];\n\n    return activities;\n  } catch (error: any) {\n    console.error(\"Failed to fetch guest activities:\", error);\n    return [];\n  }\n}\n","export {logout as '00f497f1f80dfe93943451c06664f4127784cb3b2c'} from 'ACTIONS_MODULE0'\nexport {createActivity as '4093677df15a691f79b9cb9ce3b204c7a80ac2e1f6'} from 'ACTIONS_MODULE1'\nexport {updateActivity as '608b8ecf7bcf672259111e83ff9d1fdd254243c838'} from 'ACTIONS_MODULE1'\nexport {deleteActivity as '4059e57844d4ecdbe90674012c6944c857f0d2e812'} from 'ACTIONS_MODULE1'\nexport {getActivities as '0029907054bb533d649e0cb8363cb92ada7167165e'} from 'ACTIONS_MODULE1'\nexport {getActivityRegistrations as '406e02b10a7397e5dc5b47a78b613db42fbb599d85'} from 'ACTIONS_MODULE1'\nexport {addStudentToActivity as '406f178211d76a54e61fe86f5f14c9006f5beb072b'} from 'ACTIONS_MODULE1'\nexport {removeStudentFromActivity as '405ec7b88a7417ca9286d6d3f1eb7f5278f5dd0875'} from 'ACTIONS_MODULE1'\nexport {getActivityReservations as '40ab32aabd37baaf13619ac786fe6ba3b765614849'} from 'ACTIONS_MODULE1'\nexport {addGuestToActivity as '40556636c39d7e57a9b537d18c9d96372cb097778a'} from 'ACTIONS_MODULE1'\nexport {removeGuestFromActivity as '4088ca76255c9d7d24cdbac7e2ada697db7876ce7b'} from 'ACTIONS_MODULE1'\nexport {getStudents as '00d9aceb431ba52b8dbfaaa55a20c815bf08a93a45'} from 'ACTIONS_MODULE2'\nexport {getEvents as '00c9aac6b33d1d5b8b4a10e4a172d3a9f8ea8c3f92'} from 'ACTIONS_MODULE3'\nexport {getClubs as '00e1ea61c1c9e73b2b6038b22b957d4558fcf03f9a'} from 'ACTIONS_MODULE4'\nexport {getGuests as '00f0fbd698796520ff05242b59f678368a7d863381'} from 'ACTIONS_MODULE5'\nexport {getActivityById as '40e025b20ccdc23e088c3bf2009f19c7eb055378d3'} from 'ACTIONS_MODULE1'\nexport {getActivityEvent as '408ce5a9f748b35313f03680b86ec2bb0a70ac3bf6'} from 'ACTIONS_MODULE1'\nexport {getActivityClub as '40dddd9cd1381153508219f86179015b0a89e2f7b6'} from 'ACTIONS_MODULE1'\nexport {getActivityGuests as '40ccc803938615b356e948a03f53eba1c89b055021'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OAGO,eAAe,IACpB,GAAI,CAEF,OAAO,AADQ,EAAA,OAAE,CAAC,OAAO,CAAC,8CAA8C,GAAG,EAE7E,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,EAAE,AACX,CACF,CAGO,eAAe,EAAY,CAAkB,EAClD,IAAM,EAAW,EAAS,GAAG,CAAC,cACxB,EAAQ,EAAS,GAAG,CAAC,eACrB,EAAQ,EAAS,GAAG,CAAC,eAE3B,GAAI,CASF,OARa,AAKb,EALa,OAAE,CAAC,OAAO,CAAC,CAAC;;;IAGzB,CAAC,EAEI,GAAG,CAAC,CAAE,WAAU,cAAO,CAAM,GAElC,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,WACR,CAAE,SAAS,EAAM,QAAS,4BAA6B,CAChE,CAAE,MAAO,EAAY,CACnB,MAAO,CAAE,QAAS,GAAO,QAAS,EAAM,OAAO,AAAC,CAClD,CACF,CAGO,eAAe,EAAY,CAAe,EAC/C,GAAI,CAKF,OAHA,AADa,EAAA,OAAE,CAAC,OAAO,CAAC,wCACnB,GAAG,CAAC,GAET,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,WACR,CAAE,SAAS,EAAM,QAAS,4BAA6B,CAChE,CAAE,MAAO,EAAY,CACnB,MAAO,CAAE,SAAS,EAAO,QAAS,EAAM,OAAO,AAAC,CAClD,CACF,CAYO,eAAe,EAAmB,CAAe,EACtD,GAAI,CAiBF,OAhBmB,AAgBZ,EAhBY,OAAE,CAAC,OAAO,CAAC,CAAC;;;;;;;;;;;;;;IAc/B,CAAC,EAAE,GAAG,CAAC,EAGT,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,oCAAqC,GAC5C,EAAE,AACX,CACF,0CA7EsB,EAWA,EAqBA,EAsBA,IAtDA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAWA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAqBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAsBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,yHC7DtB,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAUA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA"}