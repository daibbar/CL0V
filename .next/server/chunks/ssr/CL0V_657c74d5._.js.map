{"version":3,"sources":["../../../../../CL0V/actions/guest-actions.ts","../../../../../CL0V/.next-internal/server/app/%28dashboard%29/guests/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["'use server'\n\nimport db from '@/lib/db';\nimport { Guest, GuestRole } from '@/types/db';\nimport { revalidatePath } from 'next/cache';\n\n// --- READ GUESTS ---\nexport async function getGuests() {\n  try {\n    const guests = db.prepare('SELECT * FROM guests ORDER BY fullName ASC').all() as Guest[];\n    return guests;\n  } catch (error: any) {\n    console.error(\"Failed to fetch guests:\", error);\n    return [];\n  }\n}\n\n// --- CREATE GUEST ---\nexport async function createGuest(formData: FormData) {\n  const fullName = formData.get('guest_name') as string;\n  const phone = formData.get('guest_phone') as string;\n  const email = formData.get('guest_email') as string;\n\n  try {\n    const stmt = db.prepare(`\n      INSERT INTO guests (fullName, phone, email)\n      VALUES (@fullName, @phone, @email)\n    `);\n\n    stmt.run({ fullName, phone, email });\n    \n    revalidatePath('/guests');\n    return { success: true, message: 'Guest created successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- DELETE GUEST ---\nexport async function deleteGuest(guestId: number) {\n  try {\n    const stmt = db.prepare('DELETE FROM guests WHERE guestId = ?');\n    stmt.run(guestId);\n\n    revalidatePath('/guests');\n    return { success: true, message: 'Guest deleted successfully' };\n  } catch (error: any) {\n    return { success: false, message: error.message };\n  }\n}\n\n// --- GET GUEST ACTIVITIES ---\nexport type GuestActivityInvitation = {\n  activityName: string;\n  activityType: string;\n  startDate: string;\n  roleDescription: string;\n  eventName: string | null;\n  clubName: string | null;\n};\n\nexport async function getGuestActivities(guestId: number) {\n  try {\n    const activities = db.prepare(`\n      SELECT \n        a.activityName,\n        a.type as activityType,\n        a.startDate,\n        gr.roleDescription,\n        e.eventName,\n        c.clubName\n      FROM guestRoles gr\n      JOIN activities a ON gr.activityId = a.activityId\n      LEFT JOIN events e ON a.eventId = e.eventId\n      LEFT JOIN clubs c ON a.clubId = c.clubId\n      WHERE gr.guestId = ?\n      ORDER BY a.startDate DESC\n    `).all(guestId) as GuestActivityInvitation[];\n\n    return activities;\n  } catch (error: any) {\n    console.error(\"Failed to fetch guest activities:\", error);\n    return [];\n  }\n}\n","export {logout as '00f497f1f80dfe93943451c06664f4127784cb3b2c'} from 'ACTIONS_MODULE0'\nexport {getGuests as '00f0fbd698796520ff05242b59f678368a7d863381'} from 'ACTIONS_MODULE1'\nexport {createGuest as '40d7baee599e7dd3c0eed2fc9c70e5a30bc8ef4d9d'} from 'ACTIONS_MODULE1'\nexport {deleteGuest as '4085dcb6e0f2f3ac91072545b3585e7dd370b1b303'} from 'ACTIONS_MODULE1'\nexport {getGuestActivities as '408d74a6d16580f8f48508ec8b892ba29f00ad2c4d'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OAGO,eAAe,IACpB,GAAI,CAEF,OAAO,AADQ,EAAA,OAAE,CAAC,OAAO,CAAC,8CAA8C,GAAG,EAE7E,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,EAAE,AACX,CACF,CAGO,eAAe,EAAY,CAAkB,EAClD,IAAM,EAAW,EAAS,GAAG,CAAC,cACxB,EAAQ,EAAS,GAAG,CAAC,eACrB,EAAQ,EAAS,GAAG,CAAC,eAE3B,GAAI,CASF,OARa,AAKb,EALa,OAAE,CAAC,OAAO,CAAC,CAAC;;;IAGzB,CAAC,EAEI,GAAG,CAAC,UAAE,QAAU,QAAO,CAAM,GAElC,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,WACR,CAAE,SAAS,EAAM,QAAS,4BAA6B,CAChE,CAAE,MAAO,EAAY,CACnB,MAAO,CAAE,SAAS,EAAO,QAAS,EAAM,OAAQ,AAAD,CACjD,CACF,CAGO,eAAe,EAAY,CAAe,EAC/C,GAAI,CAKF,OAJa,AACb,EADa,OAAE,CAAC,OAAO,CAAC,wCACnB,GAAG,CAAC,GAET,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,WACR,CAAE,SAAS,EAAM,QAAS,4BAA6B,CAChE,CAAE,MAAO,EAAY,CACnB,MAAO,CAAE,SAAS,EAAO,QAAS,EAAM,OAAO,AAAC,CAClD,CACF,CAYO,eAAe,EAAmB,CAAe,EACtD,GAAI,CAiBF,OAhBmB,AAgBZ,EAhBY,OAAE,CAAC,OAAO,CAAC,CAAC;;;;;;;;;;;;;;IAc/B,CAAC,EAAE,GAAG,CAAC,EAGT,CAAE,MAAO,EAAY,CAEnB,OADA,QAAQ,KAAK,CAAC,oCAAqC,GAC5C,EAAE,AACX,CACF,0CA7EsB,EAWA,EAqBA,EAsBA,IAtDA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAWA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAqBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAsBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,0HC7DtB,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA"}